{"ast":null,"code":"import flvjs from 'flv.js/dist/flv.min.js';\nexport default {\n  name: \"VideoFlv\",\n  data() {\n    return {\n      flvPlayer: null,\n      webrtcUrl: 'https://dbd-video-0.oss-cn-beijing.aliyuncs.com/test.flv'\n    };\n  },\n  mounted() {\n    this.webrtcPlay();\n  },\n  beforeDestroy() {\n    this.destoryVideo();\n  },\n  methods: {\n    webrtcPlay() {\n      if (flvjs.isSupported()) {\n        if (this.flvPlayer) {\n          this.flvPlayer.pause();\n          this.flvPlayer.unload();\n          this.flvPlayer.detachMediaElement();\n          this.flvPlayer.destroy();\n        }\n        this.flvPlayer = flvjs.createPlayer({\n          type: 'flv',\n          url: this.webrtcUrl\n        }, {\n          cors: true,\n          //是否跨域\n          enableWorker: true,\n          //是否多线程工作\n          anableStashBuffer: false,\n          //是否启用缓存\n          stashInitialSize: 384,\n          //缓存大小(kb) 默认384kb\n          autoCleanupSourceBuffer: true //是否自动缓存\n        });\n\n        this.flvPlayer.attachMediaElement(document.getElementById('myVideo')); // 在这里绑定元素\n        this.flvPlayer.load();\n        this.flvPlayer.play();\n        //报错重连\n        this.flvPlayer.on(flvjs.Events.ERROR, (errType, errDetail) => {\n          console.log('errType:', errType);\n          console.log('errorDetail:', errDetail);\n          if (this.flvPlayer) {\n            this.destoryVideo();\n            this.webrtcPlay();\n          }\n        });\n      }\n    },\n    destoryVideo() {\n      if (this.flvPlayer) {\n        this.flvPlayer.pause();\n        this.flvPlayer.unload();\n        this.flvPlayer.detachMediaElement();\n        this.flvPlayer.destroy();\n        this.flvPlayer = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["flvjs","name","data","flvPlayer","webrtcUrl","mounted","webrtcPlay","beforeDestroy","destoryVideo","methods","isSupported","pause","unload","detachMediaElement","destroy","createPlayer","type","url","cors","enableWorker","anableStashBuffer","stashInitialSize","autoCleanupSourceBuffer","attachMediaElement","document","getElementById","load","play","on","Events","ERROR","errType","errDetail","console","log"],"sources":["src/components/htmlFlv.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n        <!-- 11111\r\n        <video></video> -->\r\n        <video autoplay controls id=\"myVideoFlv\" />\r\n        <el-button >播放</el-button>\r\n    </div>\r\n</template>   \r\n<script>\r\nimport flvjs from 'flv.js/dist/flv.min.js'\r\n\r\nexport default {\r\n    name: \"VideoFlv\",\r\n    data() {\r\n        return {\r\n            flvPlayer: null,\r\n            webrtcUrl: 'https://dbd-video-0.oss-cn-beijing.aliyuncs.com/test.flv'\r\n        }\r\n    },\r\n    mounted() {\r\n        this.webrtcPlay()\r\n    },\r\n    beforeDestroy() {\r\n        this.destoryVideo()\r\n    },\r\n    methods: {\r\nwebrtcPlay() {\r\n            if (flvjs.isSupported()) {\r\n                if (this.flvPlayer) {\r\n                    this.flvPlayer.pause()\r\n                    this.flvPlayer.unload()\r\n                    this.flvPlayer.detachMediaElement()\r\n                    this.flvPlayer.destroy()\r\n                }\r\n                this.flvPlayer = flvjs.createPlayer(\r\n                {\r\n                    type: 'flv',\r\n                    url: this.webrtcUrl\r\n                },\r\n                {\r\n                    cors: true,  //是否跨域\r\n                    enableWorker: true,  //是否多线程工作\r\n                    anableStashBuffer: false,  //是否启用缓存\r\n                    stashInitialSize: 384,  //缓存大小(kb) 默认384kb\r\n                    autoCleanupSourceBuffer: true  //是否自动缓存\r\n                }\r\n                )\r\n                this.flvPlayer.attachMediaElement(document.getElementById('myVideo'))  // 在这里绑定元素\r\n                this.flvPlayer.load()\r\n                this.flvPlayer.play()\r\n                //报错重连\r\n                this.flvPlayer.on(flvjs.Events.ERROR, (errType, errDetail) => {\r\n                console.log('errType:', errType)\r\n                console.log('errorDetail:', errDetail)\r\n                if(this.flvPlayer){\r\n                        this.destoryVideo()\r\n                        this.webrtcPlay()\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        destoryVideo() {\r\n            if (this.flvPlayer) {\r\n                this.flvPlayer.pause()\r\n                this.flvPlayer.unload()\r\n                this.flvPlayer.detachMediaElement()\r\n                this.flvPlayer.destroy()\r\n                this.flvPlayer = null\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>"],"mappings":"AASA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,SAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,UAAA;EACA;EACAC,cAAA;IACA,KAAAC,YAAA;EACA;EACAC,OAAA;IACAH,WAAA;MACA,IAAAN,KAAA,CAAAU,WAAA;QACA,SAAAP,SAAA;UACA,KAAAA,SAAA,CAAAQ,KAAA;UACA,KAAAR,SAAA,CAAAS,MAAA;UACA,KAAAT,SAAA,CAAAU,kBAAA;UACA,KAAAV,SAAA,CAAAW,OAAA;QACA;QACA,KAAAX,SAAA,GAAAH,KAAA,CAAAe,YAAA,CACA;UACAC,IAAA;UACAC,GAAA,OAAAb;QACA,GACA;UACAc,IAAA;UAAA;UACAC,YAAA;UAAA;UACAC,iBAAA;UAAA;UACAC,gBAAA;UAAA;UACAC,uBAAA;QACA,CACA;;QACA,KAAAnB,SAAA,CAAAoB,kBAAA,CAAAC,QAAA,CAAAC,cAAA;QACA,KAAAtB,SAAA,CAAAuB,IAAA;QACA,KAAAvB,SAAA,CAAAwB,IAAA;QACA;QACA,KAAAxB,SAAA,CAAAyB,EAAA,CAAA5B,KAAA,CAAA6B,MAAA,CAAAC,KAAA,GAAAC,OAAA,EAAAC,SAAA;UACAC,OAAA,CAAAC,GAAA,aAAAH,OAAA;UACAE,OAAA,CAAAC,GAAA,iBAAAF,SAAA;UACA,SAAA7B,SAAA;YACA,KAAAK,YAAA;YACA,KAAAF,UAAA;UACA;QACA;MACA;IACA;IACAE,aAAA;MACA,SAAAL,SAAA;QACA,KAAAA,SAAA,CAAAQ,KAAA;QACA,KAAAR,SAAA,CAAAS,MAAA;QACA,KAAAT,SAAA,CAAAU,kBAAA;QACA,KAAAV,SAAA,CAAAW,OAAA;QACA,KAAAX,SAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}