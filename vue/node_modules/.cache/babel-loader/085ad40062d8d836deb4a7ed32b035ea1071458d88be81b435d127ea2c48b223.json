{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AMapLoader from '@amap/amap-jsapi-loader';\nimport { shallowRef } from '@vue/reactivity';\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      cameras: [],\n      markers: []\n    };\n  },\n  methods: {\n    setup() {\n      const map = shallowRef(null);\n      return {\n        map\n      };\n    },\n    async search() {\n      try {\n        const response = await axios.get(\"http://116.204.11.171:8080/getAxises\");\n        this.cameras = response.data.data;\n        this.initMap();\n        console.log(this.cameras);\n        this.cameraID = '';\n      } catch (e) {\n        console.error(e);\n      }\n    },\n    initMap() {\n      console.log(\"现在的数据是:\" + this.cameras);\n      AMapLoader.load({\n        key: \"4355fbccd4a26bf20c3d8e74ad9afd3e\",\n        // 申请好的Web端开发者Key，首次调用 load 时必填\n        version: \"2.0\",\n        // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n        plugins: [''] // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n      }).then(AMap => {\n        this.map = new AMap.Map(\"container\", {\n          //设置地图容器id\n          viewMode: \"3D\",\n          //是否为3D地图模式\n          zoom: 5,\n          //初始化地图级别\n          center: [116.342802, 39.952291] //初始化地图中心点位置\n        });\n\n        this.cameras.forEach(cameraInfo => {\n          const title = 'cID:' + cameraInfo.cID + '\\nLon:' + cameraInfo.axis.split(',')[1] + '\\nLat:' + cameraInfo.axis.split(',')[0] + '\\n点击查看直播';\n          const marker = new AMap.Marker({\n            // position:new AMap.LngLat(parseFloat(116),parseFloat(39)),\n            position: new AMap.LngLat(parseFloat(cameraInfo.axis.split(',')[1]), parseFloat(cameraInfo.axis.split(',')[0])),\n            title: title,\n            map: this.map\n          });\n          marker.on(\"click\", () => {\n            window.open(\"http://116.204.11.171:8081?cid=\" + cameraInfo.cID);\n          });\n          this.markers.push(marker);\n        });\n        this.map.add(this.markers);\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    addMarker() {}\n  },\n  mounted() {\n    //DOM初始化完成进行地图初始化\n    this.search();\n    // this.initMap();\n  }\n};","map":{"version":3,"names":["AMapLoader","shallowRef","axios","data","cameras","markers","methods","setup","map","search","response","get","initMap","console","log","cameraID","e","error","load","key","version","plugins","then","AMap","Map","viewMode","zoom","center","forEach","cameraInfo","title","cID","axis","split","marker","Marker","position","LngLat","parseFloat","on","window","open","push","add","catch","addMarker","mounted"],"sources":["src/components/MapContainer.vue"],"sourcesContent":["<template>\r\n  <div id=\"container\"></div>\r\n</template>\r\n\r\n<style scoped>\r\n  #container{\r\n    padding:0px;\r\n    margin: 0px;\r\n    width: 100%;\r\n    height: 800px;\r\n  }\r\n</style>\r\n\r\n<script>\r\nimport AMapLoader from '@amap/amap-jsapi-loader';\r\nimport { shallowRef } from '@vue/reactivity'\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  data(){\r\n    return{\r\n      cameras:[],\r\n      markers:[],\r\n    }\r\n  },\r\n  methods:{\r\n    setup(){\r\n      const map = shallowRef(null);\r\n      return{\r\n        map,\r\n      }\r\n    },\r\n    async search(){\r\n        try {\r\n          const response = await axios.get(\"http://116.204.11.171:8080/getAxises\");\r\n          this.cameras = response.data.data;\r\n          this.initMap();\r\n          console.log(this.cameras);\r\n          this.cameraID='';\r\n        }catch (e) {\r\n          console.error(e);\r\n        }\r\n    },\r\n    initMap(){\r\n      console.log(\"现在的数据是:\"+this.cameras);\r\n      AMapLoader.load({\r\n        key:\"4355fbccd4a26bf20c3d8e74ad9afd3e\",             // 申请好的Web端开发者Key，首次调用 load 时必填\r\n        version:\"2.0\",      // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\r\n        plugins:[''],       // 需要使用的的插件列表，如比例尺'AMap.Scale'等\r\n      }).then((AMap)=>{\r\n        this.map = new AMap.Map(\"container\",{  //设置地图容器id\r\n          viewMode:\"3D\",    //是否为3D地图模式\r\n          zoom:5,           //初始化地图级别\r\n          center:[116.342802,39.952291], //初始化地图中心点位置\r\n        });\r\n        this.cameras.forEach(cameraInfo=>{\r\n          const title = 'cID:'+cameraInfo.cID+'\\nLon:'+cameraInfo.axis.split(',')[1]+'\\nLat:'+cameraInfo.axis.split(',')[0]+'\\n点击查看直播';\r\n          const marker = new AMap.Marker({\r\n            // position:new AMap.LngLat(parseFloat(116),parseFloat(39)),\r\n            position:new AMap.LngLat(parseFloat(cameraInfo.axis.split(',')[1]),parseFloat(cameraInfo.axis.split(',')[0])),\r\n            title:title,\r\n            map:this.map\r\n          });\r\n          marker.on(\"click\", () => {\r\n            window.open(\"http://116.204.11.171:8081?cid=\"+cameraInfo.cID);\r\n          });\r\n          this.markers.push(marker);\r\n        });\r\n        this.map.add(this.markers);\r\n      }).catch(e=>{\r\n        console.log(e);\r\n      })\r\n    },\r\n    addMarker(){\r\n\r\n    }\r\n  },\r\n  mounted(){\r\n    //DOM初始化完成进行地图初始化\r\n    this.search();\r\n    // this.initMap();\r\n\r\n\r\n  },\r\n}\r\n</script>\r\n"],"mappings":";AAcA,OAAAA,UAAA;AACA,SAAAC,UAAA;AACA,OAAAC,KAAA;AAEA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,OAAA;IACA;EACA;EACAC,OAAA;IACAC,MAAA;MACA,MAAAC,GAAA,GAAAP,UAAA;MACA;QACAO;MACA;IACA;IACA,MAAAC,OAAA;MACA;QACA,MAAAC,QAAA,SAAAR,KAAA,CAAAS,GAAA;QACA,KAAAP,OAAA,GAAAM,QAAA,CAAAP,IAAA,CAAAA,IAAA;QACA,KAAAS,OAAA;QACAC,OAAA,CAAAC,GAAA,MAAAV,OAAA;QACA,KAAAW,QAAA;MACA,SAAAC,CAAA;QACAH,OAAA,CAAAI,KAAA,CAAAD,CAAA;MACA;IACA;IACAJ,QAAA;MACAC,OAAA,CAAAC,GAAA,kBAAAV,OAAA;MACAJ,UAAA,CAAAkB,IAAA;QACAC,GAAA;QAAA;QACAC,OAAA;QAAA;QACAC,OAAA;MACA,GAAAC,IAAA,CAAAC,IAAA;QACA,KAAAf,GAAA,OAAAe,IAAA,CAAAC,GAAA;UAAA;UACAC,QAAA;UAAA;UACAC,IAAA;UAAA;UACAC,MAAA;QACA;;QACA,KAAAvB,OAAA,CAAAwB,OAAA,CAAAC,UAAA;UACA,MAAAC,KAAA,YAAAD,UAAA,CAAAE,GAAA,cAAAF,UAAA,CAAAG,IAAA,CAAAC,KAAA,sBAAAJ,UAAA,CAAAG,IAAA,CAAAC,KAAA;UACA,MAAAC,MAAA,OAAAX,IAAA,CAAAY,MAAA;YACA;YACAC,QAAA,MAAAb,IAAA,CAAAc,MAAA,CAAAC,UAAA,CAAAT,UAAA,CAAAG,IAAA,CAAAC,KAAA,WAAAK,UAAA,CAAAT,UAAA,CAAAG,IAAA,CAAAC,KAAA;YACAH,KAAA,EAAAA,KAAA;YACAtB,GAAA,OAAAA;UACA;UACA0B,MAAA,CAAAK,EAAA;YACAC,MAAA,CAAAC,IAAA,qCAAAZ,UAAA,CAAAE,GAAA;UACA;UACA,KAAA1B,OAAA,CAAAqC,IAAA,CAAAR,MAAA;QACA;QACA,KAAA1B,GAAA,CAAAmC,GAAA,MAAAtC,OAAA;MACA,GAAAuC,KAAA,CAAA5B,CAAA;QACAH,OAAA,CAAAC,GAAA,CAAAE,CAAA;MACA;IACA;IACA6B,UAAA,GAEA;EACA;EACAC,QAAA;IACA;IACA,KAAArC,MAAA;IACA;EAGA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}