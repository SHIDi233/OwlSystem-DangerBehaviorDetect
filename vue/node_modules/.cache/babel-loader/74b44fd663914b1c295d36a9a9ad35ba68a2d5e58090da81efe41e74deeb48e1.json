{"ast":null,"code":"import \"core-js/modules/web.url-search-params.size.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport global from './GlobalPage.vue';\nconst restweburl = global.ip;\nexport default {\n  data() {\n    //message: 'Hello Vue.js!'\n    return {\n      loginForm: {\n        mail: '1985136419@qq.com',\n        password: '123456'\n      },\n      registerForm: {\n        username: '',\n        mail: '',\n        password: '',\n        code: ''\n      },\n      confirmPassword: '',\n      registerDialogVisible: false,\n      ac: \"\",\n      pw: \"\",\n      loading: false,\n      isSendingCode: false\n      //     loginRules: {\n      //         username: [{ required: true, trigger: 'blur', validator: validateUsername }],\n      //         password: [{ required: true, trigger: 'blur', validator: validatePassword }]\n      //     },\n      // loading: false,\n      // passwordType: 'password',\n      // redirect: undefined\n    };\n  },\n\n  methods: {\n    handleLogin: function () {\n      // 获取message变量值将其转换成数组，逆转后再链接，再赋值给message\n      // alert(\"登录\");\n      // var a = this.ac;\n      // var p = this.pw;\n      // alert(a);\n      // alert(p);\n      this.loading = true;\n      var params = new URLSearchParams();\n      params.append('mail', this.loginForm.mail);\n      params.append('password', this.loginForm.password);\n      axios.post(restweburl + 'login', params).then(response => {\n        console.log(response.data);\n        // var obj = JSON.parse(response.data);\n        // console.log(obj)\n        if (response.data.code == 1) {\n          window.sessionStorage.setItem(\"DBDtoken\", response.data.data);\n          this.$router.push('/home');\n        } else {\n          alert(\"密码错误\");\n        }\n      }).catch(error => {\n        alert(error);\n        alert(\"请求失败\");\n      });\n    },\n    showRegisterDialog: function () {\n      this.registerDialogVisible = true;\n    },\n    sendCode: function () {\n      var m = this.registerForm.mail;\n      var emreg = /^\\w{3,}(\\.\\w+)*@[A-z0-9]+(\\.[A-z]{2,5}){1,2}$/;\n      if (emreg.test(m) === false) {\n        alert(\"请输入正确的邮箱地址\");\n        return;\n      }\n      if (m.length === 0) {\n        alert(\"请输入正确的邮箱地址\");\n        return;\n      }\n      var params = new URLSearchParams();\n      params.append(\"mail\", this.registerForm.mail);\n      const response = axios.post(\"http://116.204.11.171:8080/code\", params);\n      if (response.data.code === 1) {\n        alert(\"验证码已发送到指定邮箱\");\n      } else {\n        alert(\"验证码发送失败\" + response.data.msg);\n      }\n    },\n    register: function () {\n      var m = this.registerForm.mail;\n      var n = this.registerForm.name;\n      var p = this.registerForm.password;\n      var q = this.confirmPassword;\n      var code = this.registerForm.code;\n      var emreg = /^\\w{3,}(\\.\\w+)*@[A-z0-9]+(\\.[A-z]{2,5}){1,2}$/;\n      if (p != q) {\n        alert(\"两次密码不一致\");\n        return;\n      }\n      if (m == '') {\n        alert(\"邮箱地址不能为空\");\n        return;\n      } else if (emreg.test(m) == false) {\n        alert(\"请输入正确的邮箱地址\");\n        return;\n      }\n      if (n == '') {\n        alert(\"昵称不能为空\");\n        return;\n      }\n      if (p == '') {\n        alert(\"密码不能为空\");\n        return;\n      }\n      if (p.length < 5) {\n        alert(\"密码位数至少大于5\");\n        return;\n      }\n      if (code.length != 6) {\n        alert(\"验证码应为6位\");\n        return;\n      }\n      var params = new URLSearchParams();\n      params.append(\"username\", this.registerForm.username);\n      params.append(\"mail\", this.registerForm.mail);\n      params.append(\"password\", this.registerForm.password);\n      params.append(\"code\", this.registerForm.code);\n      const response = axios.post(\"http://116.204.11.171:8080/register\", params);\n      if (response.data.code === 1) {\n        alert(\"注册成功\");\n        window.sessionStorage.setItem(\"DBDtoken\", response.data.data);\n        this.$router.push('/home');\n      } else {\n        alert(\"注册失败\" + response.data.msg);\n      }\n      this.registerDialogVisible = false;\n    },\n    resetRegisterForm() {\n      this.$refs.registerForm.resetFields();\n    }\n  }\n};","map":{"version":3,"names":["axios","global","restweburl","ip","data","loginForm","mail","password","registerForm","username","code","confirmPassword","registerDialogVisible","ac","pw","loading","isSendingCode","methods","handleLogin","params","URLSearchParams","append","post","then","response","console","log","window","sessionStorage","setItem","$router","push","alert","catch","error","showRegisterDialog","sendCode","m","emreg","test","length","msg","register","n","name","p","q","resetRegisterForm","$refs","resetFields"],"sources":["src/components/LoginPage.vue"],"sourcesContent":["<style src=\"./css/login.css\" scoped></style>\r\n<template>\r\n  <body>\r\n  <div class=\"login-container\">\r\n    <el-form ref=\"form\" :model=\"loginForm\" label-width=\"80px\">\r\n      <div class=\"title-container\">\r\n        <h3 class=\"title\">WELCOME TO OWL SYSTEM</h3>\r\n      </div>\r\n      <el-form-item prop=\"username\">\r\n        <!-- <span class=\"svg-container\">\r\n            <svg-icon icon-class=\"user\" />\r\n        </span> -->\r\n\r\n        <el-input\r\n            ref=\"username\"\r\n            v-model=\"loginForm.mail\"\r\n            placeholder=\"用户名\"\r\n            name=\"username\"\r\n            type=\"text\"\r\n            tabindex=\"1\"\r\n            auto-complete=\"on\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <!-- <span class=\"svg-container\">\r\n            <svg-icon icon-class=\"password\" />\r\n        </span> -->\r\n        <el-input\r\n            :key=\"passwordType\"\r\n            ref=\"password\"\r\n            v-model=\"loginForm.password\"\r\n            :type=\"passwordType\"\r\n            placeholder=\"密码\"\r\n            name=\"password\"\r\n            tabindex=\"2\"\r\n            auto-complete=\"on\"\r\n            @keyup.enter.native=\"handleLogin\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-button :loading=\"loading\" type=\"primary\" style=\"width:100%;margin-bottom:30px;\" @click.native.prevent=\"handleLogin\">登录</el-button>\r\n      <el-button type=\"text\" @click=\"showRegisterDialog\" style=\"width:94%;margin-bottom:30px; color: #ffffff\">注册</el-button>\r\n      <el-dialog title=\"注册\" :visible.sync=\"registerDialogVisible\">\r\n        <el-form ref=\"registerForm\" :model=\"registerForm\" label-width=\"80px\">\r\n          <el-form-item label=\"用户名\" prop=\"username\">\r\n            <el-input v-model=\"registerForm.username\" placeholder=\"请输入用户名\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"邮箱\">\r\n            <el-input v-model=\"registerForm.mail\" placeholder=\"请输入邮箱\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"验证码\" prop=\"verificationCode\">\r\n            <el-row>\r\n              <el-col :span=\"18\">\r\n                <el-input v-model=\"registerForm.code\" placeholder=\"请输入验证码\" :disabled=\"isSendingCode\"></el-input>\r\n              </el-col>\r\n              <el-col :span=\"6\" style=\"padding-left: 10px;\">\r\n                <el-button type=\"primary\" @click=\"sendCode\" style=\"width: 100%;\">发送验证码</el-button>\r\n              </el-col>\r\n            </el-row>\r\n          </el-form-item>\r\n          <el-form-item label=\"密码\" prop=\"password\">\r\n            <el-input type=\"password\" v-model=\"registerForm.password\" placeholder=\"请输入密码\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\r\n            <el-input type=\"password\" v-model=\"confirmPassword\" placeholder=\"请再次输入密码\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\">\r\n          <el-button @click=\"resetRegisterForm\">重置</el-button>\r\n          <el-button type=\"primary\" @click=\"register\">注册</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </el-form>\r\n  </div>\r\n  </body>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport global from './GlobalPage.vue'\r\nconst restweburl = global.ip;\r\nexport default {\r\n  data() {\r\n\r\n    //message: 'Hello Vue.js!'\r\n    return{\r\n      loginForm: {\r\n        mail: '1985136419@qq.com',\r\n        password: '123456'\r\n      },\r\n      registerForm: {\r\n        username: '',\r\n        mail: '',\r\n        password: '',\r\n        code: ''\r\n      },\r\n      confirmPassword:'',\r\n      registerDialogVisible:false,\r\n      ac:\"\",\r\n      pw:\"\",\r\n      loading:false,\r\n      isSendingCode:false\r\n      //     loginRules: {\r\n      //         username: [{ required: true, trigger: 'blur', validator: validateUsername }],\r\n      //         password: [{ required: true, trigger: 'blur', validator: validatePassword }]\r\n      //     },\r\n      // loading: false,\r\n      // passwordType: 'password',\r\n      // redirect: undefined\r\n    }\r\n  },\r\n  methods: {\r\n    handleLogin: function () {\r\n      // 获取message变量值将其转换成数组，逆转后再链接，再赋值给message\r\n      // alert(\"登录\");\r\n      // var a = this.ac;\r\n      // var p = this.pw;\r\n      // alert(a);\r\n      // alert(p);\r\n      this.loading=true;\r\n      var params = new URLSearchParams();\r\n      params.append('mail',this.loginForm.mail);\r\n      params.append('password',this.loginForm.password);\r\n\r\n      axios.post(restweburl+'login', params).then(response => {\r\n        console.log(response.data)\r\n        // var obj = JSON.parse(response.data);\r\n        // console.log(obj)\r\n        if(response.data.code==1){\r\n          window.sessionStorage.setItem(\"DBDtoken\",response.data.data);\r\n          this.$router.push('/home');\r\n        }\r\n        else{\r\n          alert(\"密码错误\")\r\n        }\r\n      }).catch(error => {\r\n        alert(error)\r\n        alert(\"请求失败\")\r\n      })\r\n    },\r\n    showRegisterDialog:function (){\r\n      this.registerDialogVisible = true;\r\n    },\r\n    sendCode:function (){\r\n      var m = this.registerForm.mail;\r\n      var emreg=/^\\w{3,}(\\.\\w+)*@[A-z0-9]+(\\.[A-z]{2,5}){1,2}$/;\r\n      if(emreg.test(m)===false){\r\n        alert(\"请输入正确的邮箱地址\");\r\n        return;\r\n      }\r\n      if(m.length===0){\r\n        alert(\"请输入正确的邮箱地址\");\r\n        return;\r\n      }\r\n      var params = new URLSearchParams();\r\n      params.append(\"mail\",this.registerForm.mail);\r\n      const response = axios.post(\"http://116.204.11.171:8080/code\",params);\r\n      if(response.data.code===1){\r\n        alert(\"验证码已发送到指定邮箱\");\r\n      }else {\r\n        alert(\"验证码发送失败\"+response.data.msg);\r\n      }\r\n    },\r\n    register: function () {\r\n      var m = this.registerForm.mail;\r\n      var n = this.registerForm.name;\r\n      var p = this.registerForm.password;\r\n      var q = this.confirmPassword;\r\n      var code = this.registerForm.code;\r\n\r\n      var emreg=/^\\w{3,}(\\.\\w+)*@[A-z0-9]+(\\.[A-z]{2,5}){1,2}$/;\r\n      if(p!=q){\r\n        alert(\"两次密码不一致\");\r\n        return;\r\n      }\r\n      if(m==''){\r\n        alert(\"邮箱地址不能为空\");\r\n        return;\r\n      }\r\n      else if(emreg.test(m)==false){\r\n        alert(\"请输入正确的邮箱地址\");\r\n        return;\r\n      }\r\n      if(n==''){\r\n        alert(\"昵称不能为空\");\r\n        return;\r\n      }\r\n      if(p==''){\r\n        alert(\"密码不能为空\");\r\n        return;\r\n      }\r\n\r\n      if(p.length<5){\r\n        alert(\"密码位数至少大于5\");\r\n        return;\r\n      }\r\n      if(code.length!=6){\r\n        alert(\"验证码应为6位\");\r\n        return;\r\n      }\r\n      var params = new URLSearchParams();\r\n      params.append(\"username\",this.registerForm.username);\r\n      params.append(\"mail\",this.registerForm.mail);\r\n      params.append(\"password\",this.registerForm.password);\r\n      params.append(\"code\",this.registerForm.code);\r\n      const response = axios.post(\"http://116.204.11.171:8080/register\",params);\r\n      if(response.data.code===1){\r\n        alert(\"注册成功\");\r\n        window.sessionStorage.setItem(\"DBDtoken\",response.data.data);\r\n        this.$router.push('/home');\r\n      }else {\r\n        alert(\"注册失败\"+response.data.msg);\r\n      }\r\n      this.registerDialogVisible = false;\r\n\r\n    },\r\n    resetRegisterForm() {\r\n      this.$refs.registerForm.resetFields();\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n/* 修复input 背景不协调 和光标变色 */\r\n/* Detail see https://github.com/PanJiaChen/vue-element-admin/pull/927 */\r\n\r\n$bg:#283443;\r\n$light_gray:#fff;\r\n$cursor: #fff;\r\n\r\n@supports (-webkit-mask: none) and (not (cater-color: $cursor)) {\r\n  .login-container .el-input input {\r\n    color: $cursor;\r\n  }\r\n}\r\n\r\n/* reset element-ui css */\r\n.login-container {\r\n  .el-input {\r\n    display: inline-block;\r\n    height: 47px;\r\n    width: 85%;\r\n\r\n    input {\r\n      background: transparent;\r\n      border: 0px;\r\n      //   -webkit-appearance: none;\r\n      border-radius: 0px;\r\n      padding: 12px 5px 12px 15px;\r\n      color: $light_gray;\r\n      height: 47px;\r\n      caret-color: $cursor;\r\n\r\n      &:-webkit-autofill {\r\n        box-shadow: 0 0 0px 1000px $bg inset !important;\r\n        -webkit-text-fill-color: $cursor !important;\r\n      }\r\n    }\r\n  }\r\n\r\n  .el-form-item {\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    background: rgba(0, 0, 0, 0.1);\r\n    border-radius: 5px;\r\n    color: #454545;\r\n  }\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\" scoped>\r\n$bg:#2d3a4b;\r\n$dark_gray:#889aa4;\r\n$light_gray:#eee;\r\n\r\n.login-container {\r\n  min-height: 100%;\r\n  width: 100%;\r\n  background-color: $bg;\r\n  overflow: hidden;\r\n\r\n  background-image: url(\"../img/back.jpg\") ;\r\n  background-size: 100%;\r\n  background-repeat: no-repeat;\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .login-form {\r\n    position: relative;\r\n    width: 520px;\r\n    max-width: 100%;\r\n    padding: 35px 35px 10px;\r\n    margin: 0 auto;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .tips {\r\n    font-size: 14px;\r\n    color: #fff;\r\n    margin-bottom: 10px;\r\n\r\n    span {\r\n      &:first-of-type {\r\n        margin-right: 16px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .svg-container {\r\n    padding: 6px 5px 6px 15px;\r\n    color: $dark_gray;\r\n    vertical-align: middle;\r\n    width: 30px;\r\n    display: inline-block;\r\n  }\r\n\r\n  .title-container {\r\n    position: relative;\r\n\r\n    .title {\r\n      font-size: 26px;\r\n      color: $light_gray;\r\n      margin: 0px auto 40px auto;\r\n      text-align: center;\r\n      font-weight: bold;\r\n    }\r\n  }\r\n\r\n  .show-pwd {\r\n    position: absolute;\r\n    right: 10px;\r\n    top: 7px;\r\n    font-size: 16px;\r\n    color: $dark_gray;\r\n    cursor: pointer;\r\n    user-select: none;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}